{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { useGridApiMethod } from '../../utils/useGridApiMethod';\nimport { useGridLogger } from '../../utils/useGridLogger';\nimport { useGridRegisterPreProcessor } from '../../core/preProcessing';\nimport { gridPreferencePanelStateSelector } from './gridPreferencePanelSelector';\nexport var preferencePanelStateInitializer = function preferencePanelStateInitializer(state, props) {\n  var _props$initialState$p, _props$initialState;\n\n  return _extends({}, state, {\n    preferencePanel: (_props$initialState$p = (_props$initialState = props.initialState) == null ? void 0 : _props$initialState.preferencePanel) != null ? _props$initialState$p : {\n      open: false\n    }\n  });\n};\n/**\n * TODO: Add a single `setPreferencePanel` method to avoid multiple `setState`\n */\n\nexport var useGridPreferencesPanel = function useGridPreferencesPanel(apiRef) {\n  var logger = useGridLogger(apiRef, 'useGridPreferencesPanel');\n  var hideTimeout = React.useRef();\n  var immediateTimeout = React.useRef();\n  /**\n   * API METHODS\n   */\n\n  var hidePreferences = React.useCallback(function () {\n    logger.debug('Hiding Preferences Panel');\n    apiRef.current.setState(function (state) {\n      return _extends({}, state, {\n        preferencePanel: {\n          open: false\n        }\n      });\n    });\n    apiRef.current.forceUpdate();\n  }, [apiRef, logger]); // This is to prevent the preferences from closing when you open a select box or another panel,\n  // The issue is in MUI core V4 => Fixed in V5\n\n  var doNotHidePanel = React.useCallback(function () {\n    immediateTimeout.current = setTimeout(function () {\n      return clearTimeout(hideTimeout.current);\n    }, 0);\n  }, []); // This is a hack for the issue with Core V4, by delaying hiding the panel on the clickAwayListener,\n  // we can cancel the action if the trigger element still need the panel...\n\n  var hidePreferencesDelayed = React.useCallback(function () {\n    hideTimeout.current = setTimeout(hidePreferences, 100);\n  }, [hidePreferences]);\n  var showPreferences = React.useCallback(function (newValue) {\n    logger.debug('Opening Preferences Panel');\n    doNotHidePanel();\n    apiRef.current.setState(function (state) {\n      return _extends({}, state, {\n        preferencePanel: _extends({}, state.preferencePanel, {\n          open: true,\n          openedPanelValue: newValue\n        })\n      });\n    });\n    apiRef.current.forceUpdate();\n  }, [doNotHidePanel, apiRef, logger]);\n  useGridApiMethod(apiRef, {\n    showPreferences: showPreferences,\n    hidePreferences: hidePreferencesDelayed\n  }, 'ColumnMenuApi');\n  /**\n   * PRE-PROCESSING\n   */\n\n  var stateExportPreProcessing = React.useCallback(function (prevState) {\n    var preferencePanelToExport = gridPreferencePanelStateSelector(apiRef.current.state);\n\n    if (!preferencePanelToExport.open && !preferencePanelToExport.openedPanelValue) {\n      return prevState;\n    }\n\n    return _extends({}, prevState, {\n      preferencePanel: preferencePanelToExport\n    });\n  }, [apiRef]);\n  var stateRestorePreProcessing = React.useCallback(function (params, context) {\n    var preferencePanel = context.stateToRestore.preferencePanel;\n\n    if (preferencePanel != null) {\n      apiRef.current.setState(function (state) {\n        return _extends({}, state, {\n          preferencePanel: preferencePanel\n        });\n      });\n    }\n\n    return params;\n  }, [apiRef]);\n  useGridRegisterPreProcessor(apiRef, 'exportState', stateExportPreProcessing);\n  useGridRegisterPreProcessor(apiRef, 'restoreState', stateRestorePreProcessing);\n  /**\n   * EFFECTS\n   */\n\n  React.useEffect(function () {\n    return function () {\n      clearTimeout(hideTimeout.current);\n      clearTimeout(immediateTimeout.current);\n    };\n  }, []);\n};","map":{"version":3,"sources":["C:/pproject-files/new-app/node_modules/@mui/x-data-grid/hooks/features/preferencesPanel/useGridPreferencesPanel.js"],"names":["_extends","React","useGridApiMethod","useGridLogger","useGridRegisterPreProcessor","gridPreferencePanelStateSelector","preferencePanelStateInitializer","state","props","_props$initialState$p","_props$initialState","preferencePanel","initialState","open","useGridPreferencesPanel","apiRef","logger","hideTimeout","useRef","immediateTimeout","hidePreferences","useCallback","debug","current","setState","forceUpdate","doNotHidePanel","setTimeout","clearTimeout","hidePreferencesDelayed","showPreferences","newValue","openedPanelValue","stateExportPreProcessing","prevState","preferencePanelToExport","stateRestorePreProcessing","params","context","stateToRestore","useEffect"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { useGridApiMethod } from '../../utils/useGridApiMethod';\nimport { useGridLogger } from '../../utils/useGridLogger';\nimport { useGridRegisterPreProcessor } from '../../core/preProcessing';\nimport { gridPreferencePanelStateSelector } from './gridPreferencePanelSelector';\nexport const preferencePanelStateInitializer = (state, props) => {\n  var _props$initialState$p, _props$initialState;\n\n  return _extends({}, state, {\n    preferencePanel: (_props$initialState$p = (_props$initialState = props.initialState) == null ? void 0 : _props$initialState.preferencePanel) != null ? _props$initialState$p : {\n      open: false\n    }\n  });\n};\n/**\n * TODO: Add a single `setPreferencePanel` method to avoid multiple `setState`\n */\n\nexport const useGridPreferencesPanel = apiRef => {\n  const logger = useGridLogger(apiRef, 'useGridPreferencesPanel');\n  const hideTimeout = React.useRef();\n  const immediateTimeout = React.useRef();\n  /**\n   * API METHODS\n   */\n\n  const hidePreferences = React.useCallback(() => {\n    logger.debug('Hiding Preferences Panel');\n    apiRef.current.setState(state => _extends({}, state, {\n      preferencePanel: {\n        open: false\n      }\n    }));\n    apiRef.current.forceUpdate();\n  }, [apiRef, logger]); // This is to prevent the preferences from closing when you open a select box or another panel,\n  // The issue is in MUI core V4 => Fixed in V5\n\n  const doNotHidePanel = React.useCallback(() => {\n    immediateTimeout.current = setTimeout(() => clearTimeout(hideTimeout.current), 0);\n  }, []); // This is a hack for the issue with Core V4, by delaying hiding the panel on the clickAwayListener,\n  // we can cancel the action if the trigger element still need the panel...\n\n  const hidePreferencesDelayed = React.useCallback(() => {\n    hideTimeout.current = setTimeout(hidePreferences, 100);\n  }, [hidePreferences]);\n  const showPreferences = React.useCallback(newValue => {\n    logger.debug('Opening Preferences Panel');\n    doNotHidePanel();\n    apiRef.current.setState(state => _extends({}, state, {\n      preferencePanel: _extends({}, state.preferencePanel, {\n        open: true,\n        openedPanelValue: newValue\n      })\n    }));\n    apiRef.current.forceUpdate();\n  }, [doNotHidePanel, apiRef, logger]);\n  useGridApiMethod(apiRef, {\n    showPreferences,\n    hidePreferences: hidePreferencesDelayed\n  }, 'ColumnMenuApi');\n  /**\n   * PRE-PROCESSING\n   */\n\n  const stateExportPreProcessing = React.useCallback(prevState => {\n    const preferencePanelToExport = gridPreferencePanelStateSelector(apiRef.current.state);\n\n    if (!preferencePanelToExport.open && !preferencePanelToExport.openedPanelValue) {\n      return prevState;\n    }\n\n    return _extends({}, prevState, {\n      preferencePanel: preferencePanelToExport\n    });\n  }, [apiRef]);\n  const stateRestorePreProcessing = React.useCallback((params, context) => {\n    const preferencePanel = context.stateToRestore.preferencePanel;\n\n    if (preferencePanel != null) {\n      apiRef.current.setState(state => _extends({}, state, {\n        preferencePanel\n      }));\n    }\n\n    return params;\n  }, [apiRef]);\n  useGridRegisterPreProcessor(apiRef, 'exportState', stateExportPreProcessing);\n  useGridRegisterPreProcessor(apiRef, 'restoreState', stateRestorePreProcessing);\n  /**\n   * EFFECTS\n   */\n\n  React.useEffect(() => {\n    return () => {\n      clearTimeout(hideTimeout.current);\n      clearTimeout(immediateTimeout.current);\n    };\n  }, []);\n};"]},"metadata":{},"sourceType":"module"}